# 1) cat /etc/passwd in a container
- rule: Cat etc passwd
  desc: Detect reading /etc/passwd with cat inside a container
  condition: >
    container and proc.name = cat and
    (fd.name = /etc/passwd or
     (evt.type in (open,openat,openat2) and fd.name startswith /etc/passwd))
  output: >
    Falco: cat /etc/passwd in container (user=%user.name proc=%proc.name file=%fd.name
    container=%container.name image=%container.image.repository id=%container.id)
  priority: WARNING
  tags: [container, filesystem, exfil]

# 2) /bin/sh interactive exec (already similar in default but keep explicit)
- rule: Terminal shell in container
  desc: Detects an interactive shell spawned in a container
  condition: >
    container and proc.name in (sh,bash,zsh,ash) and
    evt.type=execve and proc.tty != 0
  output: >
    Falco: Terminal shell started (user=%user.name proc=%proc.name
    container=%container.name image=%container.image.repository id=%container.id)
  priority: WARNING
  tags: [container, shell, exec]
