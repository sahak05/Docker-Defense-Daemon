import{c as w,j as e,A as J,f as A,b as c,g as E,r,u as Q,t as x}from"./index-DHtPeL_b.js";import{f as W,h as L,i as _,j as ee,k as se}from"./dashboard-CTd77nbb.js";import{C as g,b as p,c as f,a as j,B as C}from"./button-CjhLNr1v.js";import{D as te,a as ae,b as re,c as ne,d as oe,e as le}from"./dialog-quAqh7LN.js";import{B as ce}from"./badge-HVe6nmkD.js";import{R as z}from"./refresh-cw-BYpHREaA.js";import{C as ie}from"./circle-x-DfhPwigA.js";import{C as de}from"./circle-check-CA32e_Ns.js";import{S as M}from"./server-Bzexg-Vh.js";import{P as me}from"./progress-CyXfUX3y.js";import"./index-Dv7bi_y4.js";import"./Combination-Cw94Wu9k.js";const he=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],ue=w("circle-stop",he);const xe=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],T=w("cpu",xe);const ge=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],pe=w("hard-drive",ge);const fe=[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]],je=w("memory-stick",fe);const ye=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],ke=w("network",ye),N="text-muted-foreground",D="text-foreground",Ne=({daemonInfo:s,onRestart:i,onStop:n})=>{const o=(h=>{switch(h.toLowerCase()){case"running":return{backgroundColor:c.success[50],color:c.success[700],borderColor:c.success[200],icon:de};case"error":return{backgroundColor:c.error[50],color:c.error[700],borderColor:c.error[200],icon:ie};case"unavailable":return{backgroundColor:c.neutral[50],color:c.neutral[700],borderColor:c.neutral[200],icon:A};default:return{backgroundColor:c.neutral[50],color:c.neutral[700],borderColor:c.neutral[200],icon:A}}})(s.status),l=o.icon;return e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Daemon Status"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:N,children:"Status"}),e.jsxs(ce,{variant:"outline",style:{backgroundColor:o.backgroundColor,color:o.color,borderColor:o.borderColor},children:[e.jsx(l,{className:"h-3 w-3 mr-1"}),s.status]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:N,children:"Uptime"}),e.jsx("span",{className:D,children:s.uptime})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:N,children:"Version"}),e.jsx("span",{className:D,children:s.version})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:N,children:"Polling Interval"}),e.jsxs("span",{className:D,children:[s.pollingInterval,"ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:N,children:"Last Health Check"}),e.jsx("span",{className:D,children:new Date(s.lastCheck).toLocaleTimeString()})]}),e.jsxs("div",{className:"pt-4 flex gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:i,className:"flex-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Restart Daemon"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:n,className:"flex-1",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Stop Daemon"]})]})]})]})},v="text-muted-foreground",b="text-foreground",ve=({systemData:s})=>e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Host Information"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Operating System"}),e.jsx("span",{className:b,children:s?.hostInformation.operatingSystem||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Docker Version"}),e.jsx("span",{className:b,children:s?.hostInformation.dockerVersion||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Architecture"}),e.jsx("span",{className:b,children:s?.hostInformation.architecture||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Kernel Version"}),e.jsx("span",{className:b,children:s?.hostInformation.kernelRelease||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"API Version"}),e.jsx("span",{className:b,children:s?.hostInformation.apiVersion||"Loading..."})]})]})]}),G="text-muted-foreground",B="text-foreground",I=({icon:s,label:i,value:n,percentage:d,details:o,bgColor:l})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{style:{backgroundColor:l},className:"h-10 w-10 rounded-lg flex items-center justify-center",children:s}),e.jsxs("div",{children:[e.jsx("p",{className:G,children:i}),e.jsx("p",{className:B,children:n})]})]}),e.jsx(me,{value:typeof d=="number"?d:0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]}),be=({systemData:s})=>{const i=()=>{const t=s?.systemResources.cpu.usagePercent;return typeof t=="number"?t:t||"N/A"},n=()=>{const t=s?.systemResources.memory.usagePercent;return typeof t=="number"?t:t||"N/A"},d=()=>{const t=s?.systemResources.disk.usagePercent;return typeof t=="number"?t:t||"N/A"},o=i(),l=n(),h=d();return e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"System Resources"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(I,{icon:e.jsx(T,{className:"h-5 w-5",style:{color:E("neutral",600)}}),label:"CPU Usage",value:typeof o=="number"?`${o}%`:o,percentage:typeof o=="number"?o:0,details:`${s?.systemResources.cpu.cores||"N/A"} cores available`,bgColor:c.primary[50]}),e.jsx(I,{icon:e.jsx(je,{className:"h-5 w-5",style:{color:E("neutral",600)}}),label:"Memory Usage",value:typeof l=="number"?`${l}%`:l,percentage:typeof l=="number"?l:0,details:`${s?.systemResources.memory.usedGb} GB / ${s?.systemResources.memory.totalGb} GB`,bgColor:c.neutral[50]}),e.jsx(I,{icon:e.jsx(pe,{className:"h-5 w-5 text-amber-600"}),label:"Disk Usage",value:typeof h=="number"?`${h}%`:h,percentage:typeof h=="number"?h:0,details:`${s?.systemResources.disk.usedGb} GB / ${s?.systemResources.disk.totalGb} GB`,bgColor:c.warning[50]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{style:{backgroundColor:c.success[50]},className:"h-10 w-10 rounded-lg flex items-center justify-center",children:e.jsx(ke,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:G,children:"Last Updated"}),e.jsx("p",{className:B,children:s?.timestamp?new Date(s.timestamp).toLocaleTimeString():"Loading..."})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click refresh button above for latest data"})})]})]})})]})},Ce="text-muted-foreground",we="text-foreground",P=({label:s,value:i,detail:n})=>e.jsxs("div",{children:[e.jsx("p",{className:Ce,children:s}),e.jsx("p",{className:we,children:i}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n})]}),Se=()=>{const[s,i]=r.useState(null),[n,d]=r.useState(!0),[o,l]=r.useState(null);return r.useEffect(()=>{(async()=>{try{d(!0);const t=await W();i(t),l(null)}catch(t){const $=t instanceof Error?t.message:"Failed to fetch Docker daemon info";l($),console.error("Error fetching Docker daemon info:",t)}finally{d(!1)}})()},[]),n?e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsx("p",{className:"text-muted-foreground",children:"Loading Docker daemon info..."})})]}):o||!s?e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsx("p",{className:"text-red-500",children:o||"Failed to load Docker daemon info"})})]}):e.jsxs(g,{children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(P,{label:"Images",value:`${s.images.total} total`,detail:`${s.images.sizeGb} GB`}),e.jsx(P,{label:"Volumes",value:`${s.volumes.total} total`,detail:"Volume storage"}),e.jsx(P,{label:"Networks",value:`${s.networks.total} total`,detail:`${s.networks.bridge} bridge, ${s.networks.custom} custom`})]})})]})},De="text-foreground mb-1",Me="text-muted-foreground",$e=({isLoading:s,error:i,onRefresh:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:De,children:"System Status"}),e.jsx("p",{className:Me,children:"Monitor daemon and host system health"})]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:n,disabled:s,className:"flex items-center gap-2",children:[e.jsx(z,{className:`h-4 w-4 ${s?"animate-spin":""}`}),s?"Loading...":"Refresh"]})]}),i&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[e.jsx("p",{className:"font-medium",children:"Error loading system status"}),e.jsx("p",{className:"text-sm",children:i})]})]}),He=()=>{Q();const[s,i]=r.useState(null),[n,d]=r.useState(null),[o,l]=r.useState(!0),[h,t]=r.useState(null),[$,y]=r.useState(!1),[u,S]=r.useState(null),[R,V]=r.useState(!1),k=r.useCallback(async()=>{try{l(!0),t(null);const[a,m]=await Promise.all([L(),_().catch(()=>null)]);i(a),d(m)}catch(a){const m=a instanceof Error?a.message:"Failed to fetch system status";t(m),console.error("Error fetching system status:",a),x.error("Failed to load system status")}finally{l(!1)}},[]),H=r.useCallback(async()=>{try{l(!0);const[a,m]=await Promise.all([L(),_().catch(()=>null)]);i(a),d(m),x.success("System status refreshed")}catch(a){const m=a instanceof Error?a.message:"Failed to refresh";console.error("Error refreshing system status:",a),x.error(m)}finally{l(!1)}},[]);r.useEffect(()=>{k()},[k]);const F=r.useCallback(()=>{if(!n)return{status:"unavailable",uptime:"N/A",version:"N/A",pollingInterval:5e3,lastCheck:new Date().toISOString()};const a=n.uptime_seconds||0,m=Math.floor(a/86400),X=Math.floor(a%86400/3600),Y=Math.floor(a%3600/60),Z=`${m}d ${X}h ${Y}m`;return{status:n.docker_connected?"running":"error",uptime:Z,version:n.docker_version||"N/A",pollingInterval:5e3,lastCheck:new Date().toISOString()}},[n]),O=r.useCallback(()=>{S("restart"),y(!0)},[]),U=r.useCallback(()=>{S("stop"),y(!0)},[]),q=r.useCallback(async()=>{if(u)try{V(!0),y(!1),u==="restart"?(await ee(),x.success("Daemon restart initiated. The system will come back online shortly."),setTimeout(()=>{k()},3e3)):u==="stop"&&(await se(),x.success("Daemon stop initiated. The system is shutting down."),setTimeout(()=>{k().catch(()=>{x.error("System is offline. Please restart the daemon manually.")})},2e3))}catch(a){const m=a instanceof Error?a.message:"Failed to perform action";console.error(`Error during ${u}:`,a),x.error(`${u==="restart"?"Restart":"Stop"} failed: ${m}`)}finally{V(!1),S(null)}},[u,k]),K=r.useCallback(()=>{y(!1),S(null)},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx($e,{isLoading:o,error:h,onRefresh:H}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ne,{daemonInfo:F(),onRestart:O,onStop:U}),e.jsx(ve,{systemData:s})]}),e.jsx(be,{systemData:s}),e.jsx(Se,{}),e.jsx(te,{open:$,onOpenChange:y,children:e.jsxs(ae,{children:[e.jsxs(re,{children:[e.jsx(ne,{children:u==="restart"?"Restart Daemon?":"Stop Daemon?"}),e.jsx(oe,{children:u==="restart"?"This will restart the daemon process. The system monitoring will be temporarily unavailable during the restart, which typically takes a few seconds.":"This will stop the daemon process and halt all system monitoring. You will need to manually restart the daemon to resume monitoring."})]}),e.jsxs(le,{children:[e.jsx(C,{variant:"outline",onClick:K,disabled:R,children:"Cancel"}),e.jsx(C,{variant:u==="stop"?"destructive":"default",onClick:q,disabled:R,children:R?"Processing...":u==="restart"?"Restart":"Stop"})]})]})})]})};export{He as SystemStatusPage,He as default};
