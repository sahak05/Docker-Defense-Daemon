import{c as w,j as e,A as J,b as x,g as E,r,u as Q,t as u}from"./index-D1sIiVvK.js";import{f as W,h as A,i as L,j as X,k as ee}from"./dashboard-C4uPpP0q.js";import{C as p,b as f,c as g,a as j,B as C}from"./button-Cll9udIQ.js";import{D as se,a as te,b as ae,c as re,d as ne,e as le}from"./dialog-4R3n7hRm.js";import{B as ce}from"./badge-C2p9_LPb.js";import{C as oe}from"./circle-check-BpUi3HHm.js";import{R as _}from"./refresh-cw-BWzdybJe.js";import{S as M}from"./server-D90aBjTF.js";import{P as ie}from"./progress-CChg5DFG.js";import"./index-TCh1iRsV.js";import"./Combination-6KfI5B73.js";const de=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],me=w("circle-stop",de);const he=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],T=w("cpu",he);const ue=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],xe=w("hard-drive",ue);const pe=[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]],fe=w("memory-stick",pe);const ge=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],je=w("network",ge),k="text-muted-foreground",D="text-foreground",ye=({daemonInfo:s,onRestart:l,onStop:n})=>e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Daemon Status"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:k,children:"Status"}),e.jsxs(ce,{variant:"outline",style:{backgroundColor:x.success[50],color:x.success[700],borderColor:x.success[200]},children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),s.status]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:k,children:"Uptime"}),e.jsx("span",{className:D,children:s.uptime})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:k,children:"Version"}),e.jsx("span",{className:D,children:s.version})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:k,children:"Polling Interval"}),e.jsxs("span",{className:D,children:[s.pollingInterval,"ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:k,children:"Last Health Check"}),e.jsx("span",{className:D,children:new Date(s.lastCheck).toLocaleTimeString()})]}),e.jsxs("div",{className:"pt-4 flex gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:l,className:"flex-1",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Restart Daemon"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:n,className:"flex-1",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Stop Daemon"]})]})]})]}),v="text-muted-foreground",b="text-foreground",Ne=({systemData:s})=>e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Host Information"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Operating System"}),e.jsx("span",{className:b,children:s?.hostInformation.operatingSystem||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Docker Version"}),e.jsx("span",{className:b,children:s?.hostInformation.dockerVersion||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Architecture"}),e.jsx("span",{className:b,children:s?.hostInformation.architecture||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"Kernel Version"}),e.jsx("span",{className:b,children:s?.hostInformation.kernelRelease||"Loading..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:v,children:"API Version"}),e.jsx("span",{className:b,children:s?.hostInformation.apiVersion||"Loading..."})]})]})]}),z="text-muted-foreground",G="text-foreground",I=({icon:s,label:l,value:n,percentage:d,details:o,bgColor:c})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{style:{backgroundColor:c},className:"h-10 w-10 rounded-lg flex items-center justify-center",children:s}),e.jsxs("div",{children:[e.jsx("p",{className:z,children:l}),e.jsx("p",{className:G,children:n})]})]}),e.jsx(ie,{value:typeof d=="number"?d:0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]}),ke=({systemData:s})=>{const l=()=>{const t=s?.systemResources.cpu.usagePercent;return typeof t=="number"?t:t||"N/A"},n=()=>{const t=s?.systemResources.memory.usagePercent;return typeof t=="number"?t:t||"N/A"},d=()=>{const t=s?.systemResources.disk.usagePercent;return typeof t=="number"?t:t||"N/A"},o=l(),c=n(),h=d();return e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"System Resources"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(I,{icon:e.jsx(T,{className:"h-5 w-5",style:{color:E("neutral",600)}}),label:"CPU Usage",value:typeof o=="number"?`${o}%`:o,percentage:typeof o=="number"?o:0,details:`${s?.systemResources.cpu.cores||"N/A"} cores available`,bgColor:x.primary[50]}),e.jsx(I,{icon:e.jsx(fe,{className:"h-5 w-5",style:{color:E("neutral",600)}}),label:"Memory Usage",value:typeof c=="number"?`${c}%`:c,percentage:typeof c=="number"?c:0,details:`${s?.systemResources.memory.usedGb} GB / ${s?.systemResources.memory.totalGb} GB`,bgColor:x.neutral[50]}),e.jsx(I,{icon:e.jsx(xe,{className:"h-5 w-5 text-amber-600"}),label:"Disk Usage",value:typeof h=="number"?`${h}%`:h,percentage:typeof h=="number"?h:0,details:`${s?.systemResources.disk.usedGb} GB / ${s?.systemResources.disk.totalGb} GB`,bgColor:x.warning[50]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{style:{backgroundColor:x.success[50]},className:"h-10 w-10 rounded-lg flex items-center justify-center",children:e.jsx(je,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:z,children:"Last Updated"}),e.jsx("p",{className:G,children:s?.timestamp?new Date(s.timestamp).toLocaleTimeString():"Loading..."})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click refresh button above for latest data"})})]})]})})]})},ve="text-muted-foreground",be="text-foreground",P=({label:s,value:l,detail:n})=>e.jsxs("div",{children:[e.jsx("p",{className:ve,children:s}),e.jsx("p",{className:be,children:l}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n})]}),Ce=()=>{const[s,l]=r.useState(null),[n,d]=r.useState(!0),[o,c]=r.useState(null);return r.useEffect(()=>{(async()=>{try{d(!0);const t=await W();l(t),c(null)}catch(t){const $=t instanceof Error?t.message:"Failed to fetch Docker daemon info";c($),console.error("Error fetching Docker daemon info:",t)}finally{d(!1)}})()},[]),n?e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsx("p",{className:"text-muted-foreground",children:"Loading Docker daemon info..."})})]}):o||!s?e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsx("p",{className:"text-red-500",children:o||"Failed to load Docker daemon info"})})]}):e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Docker Daemon"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(P,{label:"Images",value:`${s.images.total} total`,detail:`${s.images.sizeGb} GB`}),e.jsx(P,{label:"Volumes",value:`${s.volumes.total} total`,detail:"Volume storage"}),e.jsx(P,{label:"Networks",value:`${s.networks.total} total`,detail:`${s.networks.bridge} bridge, ${s.networks.custom} custom`})]})})]})},we="text-foreground mb-1",Se="text-muted-foreground",De=({isLoading:s,error:l,onRefresh:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:we,children:"System Status"}),e.jsx("p",{className:Se,children:"Monitor daemon and host system health"})]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:n,disabled:s,className:"flex items-center gap-2",children:[e.jsx(_,{className:`h-4 w-4 ${s?"animate-spin":""}`}),s?"Loading...":"Refresh"]})]}),l&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[e.jsx("p",{className:"font-medium",children:"Error loading system status"}),e.jsx("p",{className:"text-sm",children:l})]})]}),ze=()=>{Q();const[s,l]=r.useState(null),[n,d]=r.useState(null),[o,c]=r.useState(!0),[h,t]=r.useState(null),[$,y]=r.useState(!1),[m,S]=r.useState(null),[R,V]=r.useState(!1),N=r.useCallback(async()=>{try{c(!0),t(null);const[a,i]=await Promise.all([A(),L().catch(()=>null)]);l(a),d(i)}catch(a){const i=a instanceof Error?a.message:"Failed to fetch system status";t(i),console.error("Error fetching system status:",a),u.error("Failed to load system status")}finally{c(!1)}},[]),B=r.useCallback(async()=>{try{c(!0);const[a,i]=await Promise.all([A(),L().catch(()=>null)]);l(a),d(i),u.success("System status refreshed")}catch(a){const i=a instanceof Error?a.message:"Failed to refresh";console.error("Error refreshing system status:",a),u.error(i)}finally{c(!1)}},[]);r.useEffect(()=>{N()},[N]);const H=r.useCallback(()=>{if(!n)return{status:"unavailable",uptime:"N/A",version:"N/A",pollingInterval:5e3,lastCheck:new Date().toISOString()};const a=n.uptime||0,i=Math.floor(a/86400),K=Math.floor(a%86400/3600),Y=Math.floor(a%3600/60),Z=`${i}d ${K}h ${Y}m`;return{status:n.docker_ok?"running":"error",uptime:Z,version:n.version||"N/A",pollingInterval:5e3,lastCheck:n.timestamp||new Date().toISOString()}},[n]),F=r.useCallback(()=>{S("restart"),y(!0)},[]),O=r.useCallback(()=>{S("stop"),y(!0)},[]),U=r.useCallback(async()=>{if(m)try{V(!0),y(!1),m==="restart"?(await X(),u.success("Daemon restart initiated. The system will come back online shortly."),setTimeout(()=>{N()},3e3)):m==="stop"&&(await ee(),u.success("Daemon stop initiated. The system is shutting down."),setTimeout(()=>{N().catch(()=>{u.error("System is offline. Please restart the daemon manually.")})},2e3))}catch(a){const i=a instanceof Error?a.message:"Failed to perform action";console.error(`Error during ${m}:`,a),u.error(`${m==="restart"?"Restart":"Stop"} failed: ${i}`)}finally{V(!1),S(null)}},[m,N]),q=r.useCallback(()=>{y(!1),S(null)},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(De,{isLoading:o,error:h,onRefresh:B}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ye,{daemonInfo:H(),onRestart:F,onStop:O}),e.jsx(Ne,{systemData:s})]}),e.jsx(ke,{systemData:s}),e.jsx(Ce,{}),e.jsx(se,{open:$,onOpenChange:y,children:e.jsxs(te,{children:[e.jsxs(ae,{children:[e.jsx(re,{children:m==="restart"?"Restart Daemon?":"Stop Daemon?"}),e.jsx(ne,{children:m==="restart"?"This will restart the daemon process. The system monitoring will be temporarily unavailable during the restart, which typically takes a few seconds.":"This will stop the daemon process and halt all system monitoring. You will need to manually restart the daemon to resume monitoring."})]}),e.jsxs(le,{children:[e.jsx(C,{variant:"outline",onClick:q,disabled:R,children:"Cancel"}),e.jsx(C,{variant:m==="stop"?"destructive":"default",onClick:U,disabled:R,children:R?"Processing...":m==="restart"?"Restart":"Stop"})]})]})})]})};export{ze as SystemStatusPage,ze as default};
